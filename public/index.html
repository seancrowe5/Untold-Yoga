<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Basic Page Needs
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta charset="utf-8">
  <title>Untold Yoga</title>
  <meta name="description" content="">
  <meta name="author" content="">

  <!-- Mobile Specific Metas
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
  
  <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/custom.css">

  <!-- Favicon
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  <link rel="icon" type="image/png" href="img/favicon.png">

</head>
<body>

  <section class="hero fullscreen">
    <img class="logo" src="img/logo.png" data-rjs="3"/>
    <div class="container hero-container">
      <h3 class="hero-content">Secret yoga classes around Chicago</h3>
      <div class="button" id="goToUpcoming">Upcoming Classes</div>
    </div> 
  </section>

  <section class="masthead-middle center halfscreen">
    <div class="container">
      <div class="started">
        <h4>Great!! Now choose a class below!</h4>
      </div>
      <div class="registration">
        <h5>Apply for Class</h5>
        <form id="form1-" onsubmit="if(validateForm('form1-')){submitForm('#form1-');} return false;" novalidate>
          <input type="text" name="name" id="form1-name" placeholder="NAME"/>
          <input type="email" name="email" id="form1-email" placeholder="EMAIL"/>
          <input type="tel" name="phone" id="form1-phone" placeholder="PHONE"/>
          <button type="submit" name="select">SUBMIT</button>
        </form>
      
      </div>
      <h3 id="upcoming">Upcoming classes:</h3>
      <div class="class-cards">
        <div class="class-card" id="event3" data-value="3">
          <h5>Sunday, October 16th</h5>
          <h5>Instructor: <span>TBA</span></h5>
          <h5>Location: <span>A secret space in River North.</span></h5>
        <button>Apply</button>
        </div>
          
        <div class="class-card" id="event4" data-value="4">
          <h5>Sunday, October 23th</h5>
          <h5>Instructor: <span>TBA</span></h5>
          <h5>Location: <span>A secret room in The Loop.</span></h5>
          <button>Apply</button>
        </div>
          
        <div class="class-card" id="event5" data-value="5">
          <h5 style="font-size: 18px;">Saturday, November 19th</h5>
          <h5>Instructor: <span>TBA</span></h5>
          <h5>Location: <span>A secret location in Lakeview.</span></h5>
          <button>Apply</button>
        </div>
        
      </div>
      <p>Can't make any of these dates? <a href="#form2-">Get notified when new classes are added!!</a></p>
    </div>
  </section>

  <section class="masthead-bottom center fullscreen">
    <div class="container">
          <h3>How do I get in?</h3>
          <div class="masthead-bottom-list">
            <h4>1. Apply for our next class</h4>
            <h4>2. If you're accepted, receive class info</h4>
            <h4>3. Show up and enjoy! :)</h4>
          </div>
          <form id="form2-" onsubmit="if(validateForm('form2-')){submitForm('#form2-');} return false;" novalidate>
            <input type="text" name="name" id="form2-name" placeholder="NAME"/>
            <input type="email" name="email" id="form2-email" placeholder="EMAIL"/>
            <input type="tel" name="phone" id="form2-phone" placeholder="PHONE"/>
            <button type="submit" name="select">Get Notified</button>
          </form>
    </div>
  </section>

</body>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classie/1.0.1/classie.min.js"></script>
  <script src="js/jquery.cookie.js"></script>
  <script type="text/javascript" src="/js/retina.min.js"></script>
  
<script>   
  $(function() { 
    retinajs( $('img') );
    
    $('#goToUpcoming').click(function() {
      $('html, body').animate({
            scrollTop: $('#upcoming').offset().top - 150
          }, 500);
    });
    
    $('.class-card').click(function() {
      var namera = $.cookie('name');
      var emailra = $.cookie('email');
      var phonera = $.cookie('phone');

      if ( namera == null || emailra == null || phonera == null) {
        $(".registration").slideDown("500");
        $('.registration').show();
        $('html, body').animate({
            scrollTop: $("#form1-").offset().top - 150
          }, 500);
        return false;
      } else if ( this.id == 'event1') {
        return false;
      } else {
        var eventra = $(this).data('value');
        var cookieData = jQuery.param({ 'name': namera, 'email': emailra, 'phone': phonera, 'event': eventra});

        $.ajax({
          type: 'POST',
          url: 'applyForClass.php', 
          data: cookieData
        })
        .done(function(response) {
          /*alert(response);*/
          $('#event' + eventra + ' button').html('Applied <i class="fa fa-check-circle"></i>');
        })
        .fail(function(data) {
          /*alert(response);*/
        });
      }
    });
      
    $('a[href*="#"]:not([href="#"])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html, body').animate({
            scrollTop: target.offset().top
          }, 500);
          return false;
        }
      }
    });
});
  
  function validateForm(form) { 
    var i = 0;
    var namer = 'error';
    var emailr = 'error';
    var phoner = 'error';
    var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;

    var formName = $('input#' + form + 'name');
    var formEmail = $('input#' + form + 'email');
    var formPhone = $('input#' + form + 'phone');

    if ( formName.val().length > 3 ) {
      namer = 'success';
      i++;
    } if ( emailReg.test(formEmail.val()) && formEmail.val().length > 5 ) {
      emailr = 'success';
      i++;
    } if ( formPhone.val().replace(/\D/g,'').length == 10 || formPhone.val().replace(/\D/g,'').length == 11 ) {
      phoner = 'success';
      i++;
    }
    
    if ( i != 3) {
      $('input').blur();
      formName.removeClass().addClass(namer);
      formEmail.removeClass().addClass(emailr);
      formPhone.removeClass().addClass(phoner);
      $('#'+form).effect( "shake", {times:2, distance: 7}, 350 );
      return false;
    } else {
      $('input').blur();
      $.cookie('name', formName.val(), { expires: 365, path: '/' });
      $.cookie('email', formEmail.val(), { expires: 365, path: '/' });
      $.cookie('phone', formPhone.val(), { expires: 365, path: '/' });
      formName.removeClass();
      formEmail.removeClass();
      formPhone.removeClass();
      return true;
    }
  }

  function submitForm(hey) {
    // Get the form.
    var form = $(hey);

    // Get the messages div.
    var formMessages = $('#form-messages');

    // Serialize the form data.
    var formData = form.serialize();
    
    // Submit the form using AJAX.
    $.ajax({
      type: 'POST',
      url: 'register.php', 
      data: formData
    })
    
    .done(function(response) {
      /*alert(response);*/
      $('.registration').hide();
      $('.started').show();
      
      // Clear the form.
      $(hey + 'name').val('');
      $(hey + 'email').val('');
      $(hey + 'phone').val('');
    })
    
    .fail(function(data) {
      /*alert(response);*/
    });
  }
</script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84669497-1', 'auto');
  ga('send', 'pageview');

</script>
</html>
